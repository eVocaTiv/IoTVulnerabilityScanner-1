import paramiko
from models import ProtocolScanner
import socket


class SSH(ProtocolScanner):

    def __init__(self, cred, target, username, password, config):
        super(SSH, self).__init__(cred, target, config)

    def verifyCredentials(self, credentials):
        c = paramiko.SSHClient()
        c.set_missing_host_key_policy(paramiko.MissingHostKeyPolicy())  # ignore unknown hosts
        c.connect(hostname=self.target.host, port=self.target.port, username=credentials["username"], password=credentials["password"])
        stdin, stdout, stderr = c.exec_command('uname -a')
        evidence = stdout.readlines()[0]
        c.close()
		return evidence