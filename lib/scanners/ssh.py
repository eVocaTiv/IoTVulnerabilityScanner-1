import paramiko
from scanners.scanner import ProtocolScanner
import socket


class SSHScanner(ProtocolScanner):

	def __init__(self, protocolName, portNumber, IPAddress):
		super(SSHScanner, self).__init__(protocolName, portNumber, IPAddress)

	def verifyCredentials(self, credentials):
		c = paramiko.SSHClient()
		c.set_missing_host_key_policy(paramiko.MissingHostKeyPolicy())  # ignore unknown hosts
		print(self.IPAddress, self.portNumber, credentials.getUsername(), credentials.getPassword())
		try:
			c.connect(hostname=self.IPAddress, port=self.portNumber, username = credentials.getUsername(), password = credentials.getPassword())
		except:
			return None
		stdin, stdout, stderr = c.exec_command('uname -a')
		evidence = stdout.readlines()[0]
		c.close()
		return evidence