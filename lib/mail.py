import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText

def CreateSMTP(email = "iotvulnerability@gmail.com", password="pi@raspberry"):
	s = smtplib.SMTP(host='smtp.gmail.com', port=587)
	s.starttls()
	s.login(email, password)
	return s

def createMessage(body, rec, messageFor = "admin"):
	dic = {}
	dic["owner"] = "Scan Results for Device Owner"
	dic["admin"] = "Scan Results for Admin"

	msg = MIMEMultipart('alternative')
	msg['From']='iotvulnerability@gmail.com'
	msg['To']= rec
	msg['Subject'] = dic[messageFor]

	data = MIMEText(body, 'html')
	msg.attach(data)
	return msg

def sendMessage(receivers, content):
	s = CreateSMTP()
	for rec in receivers:
		msg = createMessage(content, rec)
		s.send_message(msg)
		del msg
	s.quit()