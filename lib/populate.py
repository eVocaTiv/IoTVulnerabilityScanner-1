from sqlalchemy import *
from random import randrange
import time

db = create_engine('sqlite:///iot.db')

db.echo = True  # True means verbose log

metadata = MetaData(db)

scanResults = Table('ScanResults',metadata, autoload= True
	)
	
#scanResults.create()

ins = scanResults.insert()

data = [{'Timestamp':'21:02:23','Vulnerable':'Yes','IPAddress':'12:34:56:75','Device':'raspi','portNumber':34,'protocolName':'SSH','os':'Linux','arch':'x64'}]

import random 
vul = ['Yes','No']
dev = ['raspi']
protocol = ['SSH','FTP']
os_ = ['Linux']
arch_ = ['x64']
ip_ = ["10.0.1.1" , "10.0.3.14" , "172.23.35.1"]



def randomize_time(start_timestamp,end_timestamp):
    return time.strftime('%b %d %Y %I:%M:%S', time.localtime(randrange(start_timestamp,end_timestamp)))

for i in range(100):
	vulnerable = random.choice(vul)
	device = random.choice(dev)
	_os = random.choice(os_)
	_arch = random.choice(arch_)
	portN = randrange(1024)
	start_timestamp = time.mktime(time.strptime('Jun 1 2010  01:33:00', '%b %d %Y %I:%M:%S'))
	end_timestamp = time.mktime(time.strptime('Dec 1 2018  12:33:00', '%b %d %Y %I:%M:%S'))
	times = randomize_time(start_timestamp,end_timestamp)
	_ip = random.choice(ip_)
	
	prot = random.choice(protocol)
	ins.execute(Timestamp = times,Vulnerable = vulnerable,IPAddress = _ip,Device = device,portNumber = portN ,protocolName = prot ,os = _os, arch = _arch)
